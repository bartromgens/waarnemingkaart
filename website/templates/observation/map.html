{% extends "website/base_sidebar.html" %}

{% load static %}
{% load bootstrap3 %}

{% block title %}{{ page_title }} {{ block.super }}{% endblock %}

{% block sidebar %}

<div>
  <ol class="breadcrumb">
    {% if group %}
    <li><a href="{{ group.map_url }}">{{ group }}</a></li>
    {% endif %}
    {% if family %}
    <li><a href="{{ family.map_url }}">{{ family }}</a></li>
    {% endif %}
    {% if species %}
    <li class="active">{{ species }}</li>
    {% endif %}
  </ol>
</div>

<div class="container-fluid">

  <div class="row">
    <form id="map-form" action="" method="get">

      <div class="col-sm-12">
        <h5 class="text-primary">Groep</h5>
        {% bootstrap_field filter.form.group bound_css_class='' show_label=False show_help=False %}
        {{ filter.form.media }}
      </div>

      <div class="col-sm-12">
        <h5 class="text-primary">Familie</h5>
        {% bootstrap_field filter.form.family bound_css_class='' show_label=False show_help=False %}
        {{ filter.form.media }}
      </div>

      <div class="col-sm-12">
        <h5 class="text-primary">Soort</h5>
        {% bootstrap_field filter.form.species bound_css_class='' show_label=False show_help=False %}
        {{ filter.form.media }}
      </div>

      <!--<div class="col-sm-12">-->
        <!--{% bootstrap_button content='Toon Kaart' button_type='submit' %}-->
      <!--</div>-->

    </form>

    <script>
    $(".form-control").change(function() {
        $(this).closest('form').submit();
    });
    </script>
  </div>

  <hr class="hr-small"/>

  <div class="row">
    <div class="col-sm-12">

      {% if groups and not family %}
        <h4>Groepen</h4>

        {% for group in groups %}
          <h5><a href="{{ group.map_url }}">{{ group.name_nl }}</a></h5>
        {% endfor %}
      {% endif %}

      {% if group and not family %}
        <h4>Families</h4>

        {% for family in families %}
          <small>
            <a href="{{ family.map_url }}">{{ family.name_nl }}</a> ({{ family.n_observations }}){% if not forloop.last %},{% endif %}
          </small>
        {% endfor %}
      {% endif %}

      {% if family %}
        <h4>Soorten <a href="{{ family.map_url }}">{{ family }}</a></h4>

        {% for item in speciess %}
          <small>
            <a href="{{ item.map_url }}">{{ item.name_nl }}</a> ({{ item.n_observations }}){% if not forloop.last %},{% endif %}
          </small>
        {% endfor %}
      {% endif %}

    </div>
  </div>

  {% if species %}
  <hr class="hr-small"/>

  <div class="row">
    <div class="col-sm-12">
      <h4>{{ species.name_nl }}</h4>
      {% if species.wikimedia_image_url %}<img class="img-responsive" src="{{ species.wikimedia_image_url }}"/>{% endif %}
      {% if species.wikipedia_url_nl %}Wikipedia: <a href="{{ species.wikipedia_url_nl }}">{{ species.name_nl }}</a>{% endif %}
    </div>
  </div>
  {% endif %}

  <hr class="hr"/>

  <div class="row">
    <div class="col-sm-12">
      <a id="export-png" class="btn btn-primary">Download Map</a>
    </div>
  </div>

</div>
{% endblock %}


{% block main-content %}

<div id="map" class="map">
    <div id="info"></div>
</div>

<script src="{% static 'dist/main.js' %}"></script>

{% endblock %}
